<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PWA</title>
  <link id="manifestLink" rel="manifest" href="">
  <link rel="stylesheet" href="style.css">
  <style>
    button#installBtn {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 16px;
      display: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <h1>Hello PWA</h1>
  <button id="installBtn">Install App</button>

  <script src="script.js"></script>
  <script>
  const urlParams = new URLSearchParams(window.location.search);
  const appName = urlParams.get('name');

  if (!appName) {
    document.body.innerHTML = "<h2>No app name provided!</h2>";
  } else {
    // Dynamically set manifest
    const manifestLink = document.createElement("link");
    manifestLink.rel = "manifest";
    manifestLink.href = `https://code-mon-space.workers.dev/api/engine?name=${encodeURIComponent(appName)}`;
    document.head.appendChild(manifestLink);

    console.log("Manifest URL set:", manifestLink.href);

    // Optionally fetch manifest to read icons, etc.
    fetch(manifestLink.href)
      .then(res => res.json())
      .then(data => console.log("Manifest loaded:", data))
      .catch(err => console.log("Manifest fetch error:", err));
  }
  </script>
</body>
</html>
